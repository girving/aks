#!/usr/bin/env python3
"""Run certificate checker benchmarks.

Usage:
    bench/run              # Run benchmarks (default)
    bench/run bench        # Run benchmarks
    bench/run test         # Run tests
    bench/run profile      # Run profiler
    bench/run all          # Run test, bench, then profile
"""
import subprocess
import sys

TARGETS = {
    "bench": "cert-bench",
    "test": "cert-test",
    "profile": "cert-profile",
}

def run(target: str) -> int:
    exe = TARGETS.get(target)
    if exe is None:
        print(f"Unknown target: {target}")
        print(f"Available: {', '.join(TARGETS)} | all")
        return 1
    return subprocess.call(["lake", "exe", exe])

def main() -> int:
    target = sys.argv[1] if len(sys.argv) > 1 else "bench"
    if target == "all":
        for t in ["test", "bench", "profile"]:
            rc = run(t)
            if rc != 0:
                return rc
        return 0
    return run(target)

if __name__ == "__main__":
    sys.exit(main())
